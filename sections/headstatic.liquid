{% comment %}
  Static Announcement Bar — Early Black Friday
  - Black background, white text by default
  - Adjustable height and content width (length)
  - Valid step counts to avoid schema errors
{% endcomment %}

<section id="announcement-{{ section.id }}" class="announcement-bar" role="region" aria-label="Site announcement">
  <style>
    #announcement-{{ section.id }} {
      --bar-bg: {{ section.settings.bg | default: '#000000' }};
      --bar-text: {{ section.settings.text_color | default: '#ffffff' }};
      --bar-height: {{ section.settings.bar_height }}px;
      --bar-font: {{ section.settings.font_size }}px;
      --bar-weight: {{ section.settings.font_weight }};
      --bar-letter: {{ section.settings.letter_spacing }}px;
      --bar-transform: {% if section.settings.uppercase %}uppercase{% else %}none{% endif %};
      --content-max: {{ section.settings.content_max_width }}px;
    }

    #announcement-{{ section.id }} .announcement-inner{
      background: var(--bar-bg);
      color: var(--bar-text);
      height: var(--bar-height);
      display: flex;
      align-items: center;
      justify-content: {{ section.settings.alignment }};
      line-height: 1;
      width: 100%;
      box-sizing: border-box;
      padding: 0 16px;
    }

    {% if section.settings.full_width == false %}
      #announcement-{{ section.id }} .announcement-inner{
        max-width: var(--content-max);
        margin: 0 auto;
      }
    {% endif %}

    #announcement-{{ section.id }} .announcement-text{
      font-size: var(--bar-font);
      font-weight: var(--bar-weight);
      letter-spacing: var(--bar-letter);
      text-transform: var(--bar-transform);
      text-align: {{ section.settings.text_align }};
      margin: 0;
      width: 100%;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #announcement-{{ section.id }} a.announcement-link{
      color: inherit;
      text-decoration: underline;
      text-underline-offset: 2px;
    }

    {% if section.settings.sticky %}
      #announcement-{{ section.id }}{
        position: sticky;
        top: 0;
        z-index: 50;
      }
    {% endif %}

    @media (max-width: 480px){
      #announcement-{{ section.id }} .announcement-inner{ padding: 0 12px; }
      #announcement-{{ section.id }} .announcement-text{ font-size: {{ section.settings.font_size_mobile }}px; }
    }
  </style>

  <div class="announcement-inner">
    {% if section.settings.link != blank %}
      <a class="announcement-link" href="{{ section.settings.link }}" {% if section.settings.link_new_tab %}target="_blank" rel="noopener"{% endif %}>
        <p class="announcement-text">{{ section.settings.message }}</p>
      </a>
    {% else %}
      <p class="announcement-text">{{ section.settings.message }}</p>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Static Announcement Bar",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "text", "id": "message", "label": "Announcement text", "default": "Early Black Friday — 20% OFF Sitewide" },
    { "type": "url", "id": "link", "label": "Optional link" },
    { "type": "checkbox", "id": "link_new_tab", "label": "Open link in new tab", "default": false },

    { "type": "header", "content": "Layout" },
    { "type": "checkbox", "id": "full_width", "label": "Full width bar", "default": true },
    {
      "type": "range",
      "id": "content_max_width",
      "label": "Max content width (px)",
      "min": 480,
      "max": 1920,
      "step": 20,
      "default": 1200
    },
    {
      "type": "range",
      "id": "bar_height",
      "label": "Bar height (px)",
      "min": 28,
      "max": 100,
      "step": 2,
      "default": 48
    },
    {
      "type": "select",
      "id": "alignment",
      "label": "Horizontal alignment",
      "default": "center",
      "options": [
        { "value": "flex-start", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "flex-end", "label": "Right" }
      ]
    },
    { "type": "checkbox", "id": "sticky", "label": "Stick to top (optional)", "default": false },

    { "type": "header", "content": "Typography" },
    { "type": "range", "id": "font_size", "label": "Font size (px)", "min": 10, "max": 28, "step": 1, "default": 14 },
    { "type": "range", "id": "font_size_mobile", "label": "Font size mobile (px)", "min": 10, "max": 22, "step": 1, "default": 13 },
    { "type": "range", "id": "font_weight", "label": "Font weight", "min": 300, "max": 800, "step": 100, "default": 600 },
    { "type": "range", "id": "letter_spacing", "label": "Letter spacing (px)", "min": 0, "max": 2, "step": 0.1, "default": 0.2 },
    {
      "type": "select",
      "id": "text_align",
      "label": "Text alignment inside bar",
      "default": "center",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "center", "label": "Center" },
        { "value": "right", "label": "Right" }
      ]
    },
    { "type": "checkbox", "id": "uppercase", "label": "Uppercase text", "default": true },

    { "type": "header", "content": "Colors" },
    { "type": "color", "id": "bg", "label": "Background color", "default": "#000000" },
    { "type": "color", "id": "text_color", "label": "Text color", "default": "#ffffff" }
  ],
  "presets": [
    { "name": "Static Announcement Bar", "category": "Banner" }
  ]
}
{% endschema %}
